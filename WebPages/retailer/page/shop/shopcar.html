<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="wispanh=device-wispanh, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title></title>
<link href="../../css/common.css" type="text/css" rel="stylesheet" /> 
<link href="../../css/shopcar.css" type="text/css" rel="stylesheet" />

<script type="text/javascript" src="../../js/jquery.js"></script>
<script src="../../js/retailerid.js"></script>
<script>
	$(document).ready(function(){
		$.get("/webapi/account/login/test-2-135-1",{},function(){},false);
		var _list="";
		var _give="";
		var _color="";
			$.ajax({
				url:"/webapi/distributor/"+getRetailerid()+"/shoppingcart/5ce1d14e07534139ae7774d8983f04f3?isvalid=0",
				async:true,
		    	cache:false,
		        dataType:"json",
		        type:"get",
		        error:function(){alert("网络出错")},
		        success:function(data1){
		        	console.log(data1)
		        	show(data1)
		        }
			})
		
		function show(data1){
			$(".addr").text("clienton")//需要修改
			for(var i=0;i<data1.length;i++){
				if(data1[i]["itemcount"]==1){
					_color="#dbdfe4"
				}else{
					_color="#009f96"
				}
				if(data1[i]["activityitem_id"]=="" && data1[i]["salestop"]==0){
					_list+="<li id=\""+i+"\"><div class="+"\"list\""+"><i class="+"\"gouxuan\""+"></i><div class="+"\"conh\""+"><div class="+"\"yuu\""+"><img class="+"\"img1\" "+"src="+"\"../../image/shop/p7.png\""+" /><div class="+"\"yoo\""+"><img class="
					+"\"img2\" "+"src="+"\"../../image/shop/temp.jpg\""+
					" />"+data1[i]["itemname"]+"</div><p>230-465卷</p><p class="+"\"pp1\""+">￥"+data1[i]["price"]+"</p><p class="+"\"intail\""+"><span>￥18.50</span><div class="+"\"change\""+"><span class="+"\"increase\""+">+</span><span class="+"\"amount\""+">"+data1[i]["itemcount"]+"</span><span class="+"\"reduce\" style="+"\"color:"+_color+"\""+">-</span></div></p></div></div></div></li>"						
				}else if(data1[i]["activityitem_id"]=="降价" && data1[i]["salestop"]==0){
					_list+="<li id=\""+i+"\"><div class="+"\"list\""+"><i class="+"\"gouxuan\""+"></i><div class="+"\"conh\""+"><div class="+"\"yuu\""+"><img class="+"\"img1\" "+"src="+"\"../../image/shop/p7.png\""+" /><div class="+"\"yoo\""+"><img class="
					+"\"img2\" "+"src="+"\"../../image/shop/temp.jpg\""+
					" />"+data1[i]["itemname"]+"</div><p>230-465卷</p><p class="+"\"pp1\""+">￥"+data1[i]["price"]+"</p><p class="+"\"intail\""+"><span>￥18.50</span><div class="+"\"change\""+"><span class="+"\"increase\""+">+</span><span class="+"\"amount\""+">"+data1[i]["itemcount"]+"</span><span class="+"\"reduce\""+">-</span></div></p></div></div></div><div class="+"\"disc\""+
					"<div class="+"\"disc\""+" id="+"\"disc\""+
					"><span>降价</span><span>7.5折</span></div><div class="+"\"disc\""+"><span>阿萨德撒打算</span></div></li>"
				}else if(data1[i]["activityitem_id"]=="有礼" && data1[i]["salestop"]==0){
					_list+="<li id=\""+i+"\"><div class="+"\"list\""+"><i class="+"\"gouxuan\""+"></i><div class="+"\"conh\""+"><div class="+"\"yuu\""+"><img class="+"\"img1\" "+"src="+"\"../../image/shop/p7.png\""+" /><div class="+"\"yoo\""+"><img class="
					+"\"img2\" "+"src="+"\"../../image/shop/temp.jpg\""+
					" />"+data1[i]["itemname"]+"</div><p>230-465卷</p><p class="+"\"pp1\""+">￥"+data1[i]["price"]+"</p><p class="+"\"intail\""+"><span>￥18.50</span><div class="+"\"change\""+"><span class="+"\"increase\""+">+</span><span class="+"\"amount\""+">"+data1[i]["itemcount"]+"</span><span class="+"\"reduce\""+">-</span></div></p></div></div></div><div class="+"\"disc\""+
					" id="+"\"disc\""+
					"><span>有礼</span><span>7.5折</span></div><div class="+"\"disc\""+"><span>阿萨德撒打算</span></div></li>"					
				}else if(data1[i]["activityitem_id"]=="满赠" && data1[i]["salestop"]==0){
//					for(var j=0;j<data1[i]["giftitemobj"].length;j++){
//						_give+="<span>"+data1[i]["giftitemobj"][j]["itemname"]+"<em>"+data1[i]["giftcount"]+"</em></span>"
//					}
					_list+="<li id=\""+i+"\"><div class="+"\"list\""+"><i class="+"\"gouxuan\""+"></i><div class="+"\"conh\""+"><div class="+"\"yuu\""+"><img class="+"\"img1\" "+"src="+"\"../../image/shop/p7.png\""+" /><div class="+"\"yoo\""+"><img class="
					+"\"img2\" "+"src="+"\"../../image/shop/temp.jpg\""+
					" />"+data1[i]["itemname"]+"</div><p>230-465卷</p><p class="+"\"pp1\""+">￥"+data1[i]["price"]+"</p><p class="+"\"intail\""+"><span>￥18.50</span><div class="+"\"change\""+"><span class="+"\"increase\""+">+</span><span class="+"\"amount\""+">"+data1[i]["itemcount"]+"</span><span class="+"\"reduce\""+">-</span></div></p></div></div></div><div class="+"\"disc\""+
					" id="+"\"disc\""+
					"><span>买赠</span><span>7.5折</span></div><div class="+"\"disc\""+"><div>备注：<span>"+data1[i]["remark"]+"</span></div></div><div class="+"\"giveTo\""+"><b>赠品</b><div><span>  啊实打实的萨达四大       </span><span>  啊实打实的萨达四大       </span></div></div></li>"						
				}else if(data1[i]["salestop"]==1){
					_list+="<li id=\""+i+"\" style="+"\"position:relative\""+"><div class="+"\"list\""+"><i class="+"\"gouxuan2\""+"></i><div class="+"\"conh\""+"><div class="+"\"yuu\""+"><img class="+"\"img1\" "+"src="+data1[i]["itemimage"]+" /><div class="+"\"yoo\""+"><img class="+
					"\"img2\" "+"src="+"\"../../image/shop/temp.jpg\""+" />"+data1[i]["itemname"]+"</div><p>230-465卷</p><p class="+"\"pp1\""+">￥"+data1[i]["price"]+"</p><p class="+"\"intail\""+
					"><span>￥18.50</span><div class="+"\"change\""+"><span class="+"\"increase\""+">+</span><span class="+"\"amount\""+">"+data1[i]["itemcount"]+"</span><span class="+"\"reduce\""+">-</span></div></p></div></div></div><div style="+
					"\"position:absolute;left:0;top:0;width:100%;height:111px;background:#ccc;opacity:0.5\""+"></div></li>"
				}
			}
			$("section ul").html(_list)
			select()
			change(data1);
		}//"+data1[i]["giftitemobj"]["itemname"]+"
		//add()
		//function add(){
//	    	$.ajax({
//	    		url:"/webapi/distributor/"+getRetailerid()+"/shoppingcart",
//	    		contentType: "application/json; charset=utf-8",
//		    	async:true,
//		    	cache:false,
//		        dataType:"json",
//		        type:"post",
//		        data:JSON.stringify({
//		        	distributorid:"5ce1d14e07534139ae7774d8983f04f3",
//					itemid:"998a3f589426432889285a9e708f0386",
//					itemcount:20,
//					itemquality:"1",
//					itemprice:80.00,
//					isyucun:0,
//					versiontime:formaty()
//		        }),
//		        error:function(){alert("网络出错")},
//		        success:function(data){
//		        		
//		        		//sendId(data)
//		        		console.log(data)
//		        }
//	    	})
    	//}
    	function sendId(data1){
			$.ajax({
				url:"/webapi/distributor/"+getRetailerid()+"/shoppingcart/"+data1[0]["distributor_id"]+"?isvalid=0",
				dataType:"json",
				type:"get",
				error:function(){alert("网络出错")},
				success:function(){
					alert(1)
				}
			})		
    	}

		function select(){
			var _flag=1;
			$("section").on('click','.gouxuan',function(){
				if(_flag==1){
					$(this).css({"background":"none",borderColor:"#5d5c5c"});
					$()
					_flag=0
				}else{
					$(this).css({"background":"url(../../image/shop/crect.jpg) no-repeat center center","borderColor":"#5d5c5c",backgroundSize:"1.4rem 1.4rem"});
					_flag=1;
				}
			});
			$("section").on('click','.gg',function(){
				if($(this).attr("src")=="../../image/shop/crect.png"){
					$(".list").find("i").attr("class","gouxuan")
				}else{
					$(".list").find("i").attr("class","gouxuan2")
				}
			});
		}
		function change(data1){
			$(".change").on('click','.reduce',function(){
				if($(this).parent().find(".amount").text()>1){
					$(this).parent().find(".amount").text($(this).parent().find(".amount").text()-1);
					var _ind=$(this).parent().parent().parent().parent().parent().attr("id");
					var that=$(this).parent().find(".amount").text()
					$.ajax({
						type:"post",
						url:"/webapi/distributor/"+getRetailerid()+"/shoppingcart",
						async:true,
						data:{
							distributorid:"5ce1d14e07534139ae7774d8983f04f3",
							itemid:data1[_ind]["itemid"],
							itemcount:that,
							itemquality:data1[_ind]["itemquality"],
							itemprice:data1[_ind]["price"],
							isyucun:data1[_ind]["isyucun"],
							activityitemid:data1[_ind]["activityitem_id"],
							versiontime:formaty(),
							remark:""	
						},
						error:function(){},
						success:function(data){
							console.log(data);
						}
					});
				}
				if($(this).parent().find(".amount").text()==1){
					$(this).css({color:"#e3e7ea"})
				}
				
			});
			$(".change").on('click','.increase',function(){

					$(this).parent().find(".amount").text(parseInt($(this).parent().find(".amount").text())+1)
				if($(this).parent().find(".amount").text()>1){
					$(this).parent().find(".reduce").css({color:"#23aca4"})
				}				
				var _ind=$(this).parent().parent().parent().parent().parent().attr("id");
				var that=$(this).parent().find(".amount").text();
				$.ajax({
					type:"post",
					url:"/webapi/distributor/"+getRetailerid()+"/shoppingcart",
					async:true,
					data:{
						distributorid:"5ce1d14e07534139ae7774d8983f04f3",
						itemid:data1[_ind]["itemid"],
						itemcount:that,
						itemquality:data1[_ind]["itemquality"],
						itemprice:data1[_ind]["price"],
						isyucun:data1[_ind]["isyucun"],
						activityitemid:data1[_ind]["activityitem_id"],
						versiontime:formaty(),
						remark:""	
					},
					error:function(){},
					success:function(data){
						console.log(data);
					}
				});
			})
		}
		function formaty(){
			var d=new Date();
			_year=d.getFullYear();
			_month=d.getMonth()+1;
			_day=d.getDate();
			_hour=d.getHours();
			_minute=d.getMinutes();
			_second=d.getSeconds();
			_msecond=d.getMilliseconds();
			if(_hour<10){
				_hour="0"+_hour;
			}
			if(_month<10){
				_month="0"+_month;
			}
			if(_day<10){
				_day="0"+_day;
			}
			if(_minute<10){
				_minute="0"+_minute;
			}
			if(_second<10){
				_second="0"+_second;
			}
			if(_msecond<100 && _msecond>10){
				_msecond="0"+_msecond
			}else if(_msecond<10){
				_msecond="00"+_msecond
			}
			return _year+"-"+_month+"-"+_day+" "+_hour+":"+_minute+":"+_second+"."+_msecond
		}
	})
</script>
</head>

<body style="display:flex;flex-direction:column">
	<section style="overflow: auto;flex:1;">
		<div class="shop-title">
			<div>购物车<span>(30)</span></div>
			<div><span id="edit">编辑</span></div>
		</div>
		<div class="addr">
			<span class="gouxuan"></span><div>接口</div>
		</div>
		<div class="intr">
			<div>满减</div><div>奥斯卡的技术可垃圾打算看了大家按时打算的撒的撒的撒打算撒开了的紧身裤垃圾袋</div>
		</div>
		<ul>
					<li><div class="list"><i class="gouxuan"></i><div class="conh"><div class="yuu"><img class="img1" src="../../image/shop/p7.png" /><div class="yoo"><img class="img2" src="../../image/shop/temp.jpg" />啊实打实的撒旦是</div>
						<p>230-465卷</p><p class="pp1">￥314</p><p class="intail"><span>￥18.50</span><div class="change"><span id="increase">+</span><span id="amount">20</span><span id="reduce">-</span></div></p></div></div></div><div class="disc" id="disc"><span>买赠</span><span>7.5折</span></div>
						<div class="disc"><div>备注：<span></span></div></div><div class="giveTo"><b>赠品</b><div><span>  啊实打实的萨达四大       </span><span>  啊实打实的萨达四大       </span></div></div></li>
		</ul>
	</section>

 <!-- footer start -->
 <footer style="width:100%;height:5rem"></footer>
    <div class="bottomlayout">
                        
                       
                          
                       
                          
                          <!-- orderlayout 3 description -->
                          
                            <div class="totalsum">
                            	<span class="all"><img class="gg" src="../../image/shop/crect.jpg" style="width:1.4rem;height:1.4rem;border:1px solid #fff;border-radius: 1.4rem;" /><span>全选</span></span>
                                          <p class="amountBig" style="margin-left: 0;float:left"> 合计：￥50元</p> 
                                            <p style="margin-left: 0;">已优惠金额：￥139.00  </p> 
                                            <div>去提交<span>(20)</span></div>
                                      </div>
                            
                          
                          
                          
                         <!--  <div class="bottomsubmit">
                          <input type="button" data-evt="buy-cart-m/biz/go:submit" class="" >去提交(<span class="">20</span>)</input>
                          
                          </div> -->
                        </div>
  <!-- footer end -->

</body>
</html>
